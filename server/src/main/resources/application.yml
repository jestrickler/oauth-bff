# ==========================================
# BASE APPLICATION CONFIGURATION
# ==========================================
# Common configuration for all environments
# Environment-specific overrides are in application-{profile}.yml
# 
# PROFILES:
# - docker: Development (local) or cloud dev/test
# - prod: Cloud production
# 
# REQUIRED: Set SPRING_PROFILES_ACTIVE environment variable
# ==========================================

spring:
  profiles:
    active: ${SPRING_PROFILES_ACTIVE}  # Must be explicitly set (docker or prod)
  
  application:
    name: oauth-server

  security:
    oauth2:
      client:
        registration:
          github:
            client-id: ${GITHUB_CLIENT_ID}
            client-secret: ${GITHUB_CLIENT_SECRET}
          # KEYCLOAK (OIDC): Uncomment to use Keycloak instead of/alongside GitHub
          # keycloak:
          #   client-id: ${KEYCLOAK_CLIENT_ID}
          #   client-secret: ${KEYCLOAK_CLIENT_SECRET}
          #   client-authentication-method: client_secret_basic
          #   authorization-grant-type: authorization_code
          #   redirect-uri: "{baseUrl}/login/oauth2/code/keycloak"
          #   scope: openid,profile,email
          #   provider: keycloak
          # provider:
          #   keycloak:
          #     issuer-uri: ${KEYCLOAK_ISSUER_URI}
          #     # issuer-uri: https://keycloak.example.com/realms/myapp

  # Default session timeout (overridden in profiles)
  session:
    timeout: 30m

server:
  port: 8080
  
  servlet:
    session:
      cookie:
        same-site: lax
        secure: false  # Overridden in prod
        http-only: true
        path: /

logging:
  level:
    root: INFO
    org.springframework.security: INFO