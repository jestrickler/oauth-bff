# ==========================================
# DEVELOPMENT ENVIRONMENT CONFIGURATION
# ==========================================
# This profile is used for local development
# Run with: ./gradlew bootRun --args='--spring.profiles.active=dev'
# ==========================================

spring:
  application:
    name: oauth-server

  security:
    oauth2:
      client:
        registration:
          github:
            client-id: ${GITHUB_CLIENT_ID}
            client-secret: ${GITHUB_CLIENT_SECRET}
            # For production, add specific scopes:
            # scope: read:user,user:email

  # Session timeout for development (longer for convenience)
  # Production should use 15m or less for HIPAA compliance
  session:
    timeout: 30m

server:
  port: 8080
  
  servlet:
    session:
      cookie:
        # SameSite=Lax prevents CSRF attacks while allowing OAuth redirects
        # - 'lax': Cookies sent on same-site requests + top-level navigation (OAuth)
        # - 'strict': Cookies only on same-site requests (breaks OAuth redirects)
        # - 'none': Cookies sent everywhere (requires secure=true, less secure)
        same-site: lax
        
        # Secure cookies require HTTPS
        # Development: false (using HTTP)
        # Production: true (MUST use HTTPS for HIPAA)
        secure: false
        
        # HttpOnly prevents JavaScript from reading JSESSIONID (security)
        # XSRF-TOKEN intentionally has HttpOnly=false (needed for BFF pattern)
        http-only: true
        
        # Cookie path - '/' means cookie sent to all paths
        path: /
        
        # Domain - not set for localhost
        # Production: set to '.example.com' to share across subdomains

# CORS Configuration for Development
# In dev, frontend runs on :5173, backend on :8080 (different origins)
# This is LESS secure than same-origin deployment
cors:
  allowed-origins: http://localhost:5173
  # Production should restrict to actual domain

# Logging for debugging OAuth flow
logging:
  level:
    root: INFO
    org.springframework.security: DEBUG
    org.springframework.security.oauth2: DEBUG
    org.springframework.web.cors: DEBUG
